# Appendix to Chapter Four {-}

This chapter Appendix roughly aligns with the chronological order of the chapter. 

## Note on the Campaign Media Analysis Group and its Role in the Data

WiscAD and WMP gather the television advertisements with the assistance of a commercial company, the Campaign Media Analysis Group (CMAG). CMAG provides several pieces of information when releasing the data, such as the media market in which a particular advertisement aired, the estimated cost of running a particular advertisement, the time of day the advertisement was run, and other variables. A group of scholars and graduate students affiliated with WiscAD and WMP then conduct additional coding on the advertisements. This coding varies to some extent by election cycle, but otherwise remains markedly similar. The additional variables that are coded for in each election cycle include items such as the specific issues that an advertisement mentions or addresses during the advertisement, whether a candidate is featured during the advertisement, and whether a given advertisement takes on a negative tone, and more. 

Cleaning the data from five separate data sets was a considerable project. I had to merge several variables and implement a common naming scheme across the data in order to enable a meaningful comparison of the data over time. The .rmd file that contains the cleaning instructions is available for review. 

## Additional Descriptive Statistics

Figure \@ref(fig:img-type-ch4) displays the number of uses of military imagery by type. The figure shows that imagery of active duty troops and veterans are the most common forms of military imagery. In 2004 and 2008, combat imagery was more common than images containing military hardware, but in every other election (2000, 2012, and 2016), there were more advertisements featuring images of military hardware than those that featured combat imagery. The most reasonable explanation for this difference is the fact that American combat operations in Iraq and Afghanistan loomed large over the 2004 and 2008 elections, respectively. 

It is also quite clear from Figure \@ref(fig:img-type-ch4) that the 2000 election contained far less military imagery - across all imagery types - than subsequent elections. This likely reflects the post-9/11 era increase in the general prominence or the centrality of the military as an institution in politics relative to the immediate elections held in the pre-9/11 era. Finally, it is also clear that the relative gap between active duty military imagery and veteran imagery has widened. Indeed, veteran imagery has emerged as the most common form of imagery, first in 2004, but again during the 2012 and 2016 Elections. This likely underscores the role of the wars in Iraq and Afghanistan in producing veterans, and the fact that veterans of these conflicts have (and likely will) become more prominent as time passes.

```{r img-type-ch4, include=T, echo=FALSE, error=FALSE, warning=FALSE, message=F, fig.height=4, fig.width=6, fig.cap="Number of Presidental Campaign TV Ads Displaying Military Imagery"}

## prepare a graph for raw counts of image type 

# raw counts
graphable_img_types_df <- adj_df_ch4 %>% 
  select(year, act_duty_img_total, vet_img_total, us_cmbt_img_total, us_mil_hard_img_total) %>% pivot_longer(act_duty_img_total:us_mil_hard_img_total, names_to = "statistic", values_to = "Number") %>% distinct () %>% view ()

plot_img_type_count <- ggplot(data=graphable_img_types_df, aes(fill=statistic, x=year, y=Number)) + geom_bar(position="dodge", stat="identity") + labs(x="Election", y="Number of Ads") + scale_fill_discrete(name="Military Imagery Type",
                         breaks=c("act_duty_img_total", "vet_img_total", "us_cmbt_img_total", "us_mil_hard_img_total"),
                         labels=c("Active Military", "Veteran", "Combat", "Mil. Hardware")) + theme(legend.position="bottom") + scale_x_continuous(breaks=seq(2000, 2016, 4)) + guides(fill = guide_legend(ncol=2 ,nrow=2,byrow=TRUE))

plot_img_type_count

```


## Results of Logistic Regression (Ads-Based) Analysis Using Multiple Imputation

Because of missing data, there may be concerns that the results obtained are biased in some way. Indeed, this is a  real concern. The OLS Regression models in the main chapter did not evince any meaningful relationship between any variable and either the proportion of ads that violate the principles of civil-military relations, nor the violation rate of ads aired in each election cycle. I am content to conclude that at the macro level, where the unit of analysis is the election, no meaningful relationship between trust in the military and these variables (proportion of ads and violation rate of ads which violate the principles of civil-military relations) can be drawn. 

However, given that the logistic regression models portrayed a different result, namely, that the level of trust in the military does seem to shape the likelihood that an advertisement features a military figure who violates one of the principles of civil-military relations, I conduct multiple imputation for the missing data. 

The results are displayed in Table \@ref(tab:ch4mice).
```{r ch4mice-prep, include=FALSE, echo=FALSE, warning=F, message=F, error=FALSE}

## use multiple imputation to handle missing data
df_campaign_ads_raw_mice

# create a variable for candidate name
df_campaign_ads_raw_mice$candidate <- factor(sub("/.*$", "", df_campaign_ads_raw_mice$creative)) %>% print()

df_campaign_ads_raw_mice$party_reg <- factor(df_campaign_ads_raw_mice$party_reg, levels=c("DEMOCRAT","OTHER"))
table(df_campaign_ads_raw_mice$party_reg)

df_campaign_ads_raw_mice$prom_mil_fig <- factor(df_campaign_ads_raw_mice$prom_mil_fig, levels=setdiff(unique(df_campaign_ads_raw_mice$prom_mil_fig), c("")))

df_campaign_ads_raw_mice_ready <- (df_campaign_ads_raw_mice[,!sapply(df_campaign_ads_raw_mice, is.character)])

# goes through variables except count and l, made them factors, and changed 99 to 0
for (varname in setdiff(names(df_campaign_ads_raw_mice_ready), c("count", "l", "house_polar", "sen_polar", "aff_polar", "HostCasRateLagged", "mil_prestige", "prestige_gap", "party_reg" ))) {
    if (length(setdiff(unique(df_campaign_ads_raw_mice_ready[[varname]]), 99)) > 2)
        df_campaign_ads_raw_mice_ready[[varname]] <- factor(ifelse(df_campaign_ads_raw_mice_ready[[varname]]==99,0,df_campaign_ads_raw_mice_ready[[varname]]), levels=sort(setdiff(unique(df_campaign_ads_raw_mice_ready[[varname]]), 99)))
    else
        df_campaign_ads_raw_mice_ready[[varname]] <- as.integer(ifelse(df_campaign_ads_raw_mice_ready[[varname]]==99,0,df_campaign_ads_raw_mice_ready[[varname]]))
}

df_campaign_ads_raw_mice_ready$party_reg %>% print()

## conduct multiple  imputation
#make a prediction matrix first

prediction_matrix <- make.predictorMatrix(as.matrix(df_campaign_ads_raw_mice_ready), blocks = make.blocks( c("act_dty_img", "vet_img","us_mil_hard_img", "us_cmbt_img", "vet_fam", "vet_fam_end", "vet_fam_atk", "vet_fam_out_issues", "partisan_act"), partition="scatter"))

prediction_matrix[, "candidate"] <- -2

# change the variable candidate to a type of integer
df_campaign_ads_raw_mice_ready$candidate <- as.integer(df_campaign_ads_raw_mice_ready$candidate)

# put in variables you don't want to use for the imputation
#prediction_matrix[, c("")] <- 0

df_campaign_ads_raw_mice_imputed <- mice(data=df_campaign_ads_raw_mice_ready, method="2l.bin", predictorMatrix=prediction_matrix, maxit=10, m=20, blocks=as.list(rownames(prediction_matrix)))

# for MICE regressions using imputed data


mod_appearance_imp <- with(df_campaign_ads_raw_mice_imputed, glm(vet_fam ~ mil_prestige + house_polar + HostCasRateLagged + can_vet + party_reg , family=binomial(link="logit")))
imp_appearance <- summary(pool(mod_appearance_imp))

mod_anyviol_ch4_imp <- with(df_campaign_ads_raw_mice_imputed, glm(partisan_act ~ mil_prestige + sen_polar + HostCasRateLagged + can_vet + party_reg, family=binomial(link="logit")))
imp_anyviol <- summary(pool(mod_anyviol_ch4_imp))

mod_endorse_ch4_imp <- with(df_campaign_ads_raw_mice_imputed, glm(vet_fam_end ~ mil_prestige + house_polar + HostCasRateLagged + can_vet + party_reg, family=binomial(link="logit")))
imp_endorse <- summary(pool(mod_endorse_ch4_imp))

mod_atk_ch4_imp <- with(df_campaign_ads_raw_mice_imputed, glm(vet_fam_atk ~ mil_prestige + sen_polar + HostCasRateLagged + can_vet + party_reg, family=binomial(link="logit")))
imp_atk <- summary(pool(mod_atk_ch4_imp)) %>% print()

mod_int_ch4_imp <- with(df_campaign_ads_raw_mice_imputed, glm(vet_fam_out_issues ~ mil_prestige + house_polar + HostCasRateLagged + can_vet + party_reg, family=binomial(link="logit")))
imp_int <- summary(pool(mod_int_ch4_imp)) %>% print()

### Extra here ###

## One way is to use kable.  Not ideal, but perfectly acceptable. 
imp_int_df <- tibble(imp_int)

kable(imp_int_df, booktabs=T, caption="Multiple Imputation, DV: Log Odds of Addressing Outside Topic") %>%
  kable_styling(full_width = F, font_size=10.5, latex_options="striped") %>% 
  column_spec(1:2, width="5em") %>% 
  column_spec(3:6, width="5.5em")

```

```{r ch4mice, include=T, echo=FALSE, error=FALSE, warning=FALSE, message=FALSE}

models_imputed <- list(
  "Appear" = mod_appearance_imp,
  "Any Violation" = mod_anyviol_ch4_imp,
  "Endorse" = mod_endorse_ch4_imp, 
  "Attack" = mod_atk_ch4_imp,
  "Outside Topic" = mod_int_ch4_imp
)

cm <-c("mil_prestige"="Trust in Military", "house_polar" ="House Polarization", "sen_polar"="Senate Polarization", "HostCasRateLagged"="Casualty Rate (lagged)","can_vet"="Candidate-Veteran","party_regOTHER"="Party-Other", "(Intercept)"="Constant")

modelsummary(models_imputed, stars=c("*"=.1, "**"=.05, "***"=.01), coef_map = cm, format="latex", title = '(Multiple Imputation) Log Odds of a Presidential Campaign TV Ad Featuring Prominent Military Actors Engaging in Political Behaviors', notes='Here are some notes.')
```

The results of the multiple imputation indeed show that the coefficient for military prestige is positive and statistically significant in logistic models where the dependent variable is the log of the odds that a military figure prominently appears, engages in any violation, endorses, or attacks. The coefficient is not statistically significant when the dependent variable is the log of the odds of a figure addressing an outside topic. 

## The Role of Interaction Terms Between Prestige and Polarization 

This first regression analysis of the appendix presents the results of a series of regressions where I include an interaction term between polarization and military prestige. The first three models are OLS models where the dependent variable is the proportion of all ads aired in a particular election cycle that violate the principles of civil-military relations sponsored by any entity, only political parties or candidates, and interest groups, respectively. Models 4-6 are also OLS models where the dependent variable is the violations rate of ads aired in an election cycle sponsored by any entity, only political parties or candidates, and interest groups, respectively. Finally, models 7-9 are instead logistic regressions, where the dependent variable is the log of the odds that an advertisement aired by any entity, only parties or candidates, and interest groups violates any one of the principles of civil-military relations, respectively. The results are displayed in Table \@ref(tab:ch4appx-int).

```{r appx-int-terms, include=F, echo=F, message=F, warning=F}
##DV is prop_ads_violating produced by all entities
mod_ols_prop_violating_int <- lm(prop_ads_violating ~ mil_prestige + house_polar + mil_prestige*house_polar, data=reg_df_ch4_ols)
summary(mod_ols_prop_violating_int)

# DV is prop_ads produced by parties/candidates
no_ig_ols_prop_violating_int <- lm(prop_ads_violating ~ mil_prestige + sen_polar + mil_prestige*sen_polar, data=drop_igs_violations_wrap_ols)
summary(no_ig_ols_prop_violating_int)

# DV is prop_ads produced by int groups
ig_ols_prop_violating_int <- lm(prop_ads_violating ~ mil_prestige + house_polar + house_polar*mil_prestige, data=igs_violations_wrap_ols)
summary(ig_ols_prop_violating_int)

##DV is violations rate of ads produced by all entities
mod_ols_violations_rate_int <- lm(violations_rate ~ mil_prestige + house_polar + mil_prestige*house_polar, data=reg_df_ch4_ols)
summary(mod_ols_violations_rate_int)

# DV is violations rate of ads produced by parties/candidates
no_ig_ols_violations_rate_int <- lm(violations_rate ~ mil_prestige + sen_polar + mil_prestige*sen_polar, data=drop_igs_violations_wrap_ols)
summary(no_ig_ols_violations_rate_int)

# DV is violations rate of ads produced by int groups
ig_ols_violations_rate_int <- lm(violations_rate ~ mil_prestige + house_polar + mil_prestige*house_polar, data=igs_violations_wrap_ols)
summary(ig_ols_violations_rate_int)


## DV is log odds an ad violates any principles (all ads)
mod_anyviol_ch4_int <- glm(partisan_act ~ mil_prestige + sen_polar + HostCasRateLagged + can_vet + party_reg + mil_prestige*sen_polar, 
    family=binomial(link="logit"),
    data=reg_df_ch4
    )
summary(mod_anyviol_ch4_int)

# DV is log odds an ad violates any principles (parties / cand only)
noig_anyviol_ch4_int <- glm(partisan_act ~ mil_prestige + sen_polar + HostCasRateLagged + can_vet + party_reg + mil_prestige*sen_polar, 
    family=binomial(link="logit"),
    data=no_ig_reg_df_ch4
    )
summary(noig_anyviol_ch4_int)

# DV is log odds an ad violates any principles (int groups)
ig_anyviol_ch4_int <- glm(partisan_act ~ mil_prestige + sen_polar + HostCasRateLagged + can_vet + party_reg + mil_prestige*sen_polar, 
    family=binomial(link="logit"),
    data=ig_reg_df_ch4
    )
summary(ig_anyviol_ch4_int)
```
\singlespace
```{r endogch4appx results-intterms, include=T, echo=FALSE, results="asis", warning=FALSE, message=FALSE}
stargazer(mod_ols_prop_violating_int, no_ig_ols_prop_violating_int, ig_ols_prop_violating_int, mod_ols_violations_rate_int, no_ig_ols_violations_rate_int, ig_ols_violations_rate_int, mod_anyviol_ch4_int, noig_anyviol_ch4_int, ig_anyviol_ch4_int,
          type="latex",
          label="tab:ch4appx-int",
          title="Regression Results, Including Interaction Terms", 
          covariate.labels = c('Trust in Military', 'House Polarization', 'Trust*Polarization (house)', 'Senate Polarization', 'Casualty Rate (lagged)', 'Candidate-Veteran', 'Party-Other', 'Party-GOP', 'Trust*Polarization (sen.)'),
          dep.var.labels = c('Proportion Violating', 'Violation Rate', 'Log Odds of Violating Any Principle'),
          model.names=T,
          header=FALSE,
          column.sep.width = "-15pt",
          align=TRUE,
          font.size="small",
          no.space=TRUE,
          omit.stat=c("f", "ser"),
          float.env = "sidewaystable"
          )
```
\doublespace

Table \@ref(tab:ch4appx-int) shows that across model specifications, the term that interacts the levels of trust in the military with polarization are statistically insignificant.  In the OLS models, substantively, these terms take on a value that is very close to 0, suggesting that the interaction of the levels of trust and polarization matter very little; in the logistic regression models, the terms are all negative, but the standard errors of the coefficients are very large. In short, the interaction between polarization and prestige seems to matter very little.  

## Role of the 2004 Election

## Endogeneity Checks

In this section of the Appendix, I check for endogeneity, and in particular, the relationship between military prestige and instances of military figures appearing in civilian campaign advertisements who either endorse or attack political candidates, or address a topic that is tangential to or outside of military expertise. 

First, I regress the level of military prestige on either the proportion of each election cycle's advertisements that violate principles of civil-military relations as well as the overall violation rate of each in each election cycle. I also include controls for various measurements of polarization and a measure of the lagged hostile casualty rate, as described in the main chapter. The results of this regression are displayed in Table \@ref(tab:ch4appx1). 

```{r ch4endogtest, include=F, echo=F, message=F, warning=F}
## regress the level of military prestige
## on the proportion of ads violating civ mil principles
## and the violations rate of each cycle's ads

## do this for all ads (data=ch4_endog_ols_house)
## for no ig's (data=drop_igs_violations_wrap_ols)
## and only ig's (data=igs_violations_wrap_ols)

# all ads
ch4_endog_ols_house <- lm(mil_prestige ~ prop_ads_violating + house_polar + HostCasRateLagged, data=reg_df_ch4_ols)
summary(ch4_endog_ols_house)

ch4_endog_ols_house_rate <- lm(mil_prestige ~ violations_rate + house_polar + HostCasRateLagged, data=reg_df_ch4_ols)
summary(ch4_endog_ols_house_rate)

# no int groups
no_ig_ch4_endog_ols_sen <- lm(mil_prestige ~ prop_ads_violating + sen_polar + HostCasRateLagged, data=drop_igs_violations_wrap_ols)
summary(no_ig_ch4_endog_ols_sen)

no_ig_ch4_endog_ols_sen_rate <- lm(mil_prestige ~ violations_rate + sen_polar + HostCasRateLagged, data=drop_igs_violations_wrap_ols)
summary(no_ig_ch4_endog_ols_sen_rate)

# only interest groups
ig_ch4_endog_ols_house <- lm(mil_prestige ~ prop_ads_violating + house_polar + HostCasRateLagged, data=igs_violations_wrap_ols)
summary(ig_ch4_endog_ols_house)

ig_ch4_endog_ols_house_rate <- lm(mil_prestige ~ violations_rate + house_polar + HostCasRateLagged, data=igs_violations_wrap_ols)
summary(ig_ch4_endog_ols_house_rate)

```

\singlespace
```{r endogch4appx results1, include=T, echo=FALSE, results="asis", warning=FALSE, message=FALSE}
stargazer(ch4_endog_ols_house, ch4_endog_ols_house_rate, no_ig_ch4_endog_ols_sen, no_ig_ch4_endog_ols_sen_rate, ig_ch4_endog_ols_house, ig_ch4_endog_ols_house_rate,
          type="latex",
          label="tab:ch4appx1",
          title="Regression Results, Endogeneity Checks (Regress Military Prestige on the Proportion or Rate of Ads Violating Principles of Civil-Military Relations in Each Election Cycle)", 
          covariate.labels = c('Proportion Violating', 'Violating Rate', 'House Polarization', 'Senate Polarization', 'Casualty Rate (lagged)'),
          dep.var.labels = c('Level of Military Prestige'),
          model.names=T,
          header=FALSE,
          column.sep.width = "-15pt",
          align=TRUE,
          font.size="small",
          no.space=TRUE,
          omit.stat=c("f", "ser")
          )
```
\doublespace

The results indicate that there is no statistically significant relationship between either the proportion of violating ads or the violation rate in each election cycle and the level of military prestige. Furthermore, the standard errors of the coefficients are very large, further casting suspicion on any claims of endogeneity in these particular model set ups. 

I then change the independent variables to denote an instance of any violation to the principles of civil-military relations that occur (rather than the proportion or violations rate of ads that air across the election cycles). I include the same controls, but also include an interaction term between polarization and any instance of a violation to the principles of civil-military relations. In some models I also include a dummy control for the 2004 Election in order to see if that particular election is responsible for capturing some of the other effects of the other included variables. 

These results are displayed in Table \@ref(tab:ch4appx2).
```{r ch4endogtest2, include=F, echo=F, message=F, warning=F}

## further endog checks
## include an interaction term, and use the 
## entire data range

# all ads
ch4_endog_int <- lm(mil_prestige ~ partisan_act + house_polar + HostCasRateLagged + partisan_act*house_polar, data=reg_df_ch4)
summary(ch4_endog_int)

ch4_endog_int_04 <- lm(mil_prestige ~ partisan_act + house_polar + HostCasRateLagged + partisan_act*house_polar + dummy_04, data=reg_df_ch4)
summary(ch4_endog_int_04)

# no igs
noig_ch4_endog_int <- lm(mil_prestige ~ partisan_act + sen_polar + HostCasRateLagged + partisan_act*sen_polar, data=no_ig_reg_df_ch4)
summary(noig_ch4_endog_int)

noig_ch4_endog_int_04 <- lm(mil_prestige ~ partisan_act + sen_polar + HostCasRateLagged + partisan_act*sen_polar + dummy_04 , data=no_ig_reg_df_ch4)
summary(noig_ch4_endog_int_04)


# only interest groups
ig_ch4_endog_int <- lm(mil_prestige ~ partisan_act + house_polar + HostCasRateLagged + partisan_act*house_polar, data=ig_reg_df_ch4)
summary(ig_ch4_endog_int)

ig_ch4_endog_int_04 <- lm(mil_prestige ~ partisan_act + house_polar + HostCasRateLagged + partisan_act*house_polar + dummy_04,  data=ig_reg_df_ch4)
summary(ig_ch4_endog_int_04)


```
\singlespace
```{r endogch4appx results1, include=T, echo=FALSE, results="asis", warning=FALSE, message=FALSE}
stargazer(ch4_endog_int, ch4_endog_int_04, noig_ch4_endog_int, noig_ch4_endog_int_04, ig_ch4_endog_int, ig_ch4_endog_int_04,
          type="latex",
          label="tab:ch4appx2",
          title="Regression Results, Endogeneity Checks (Regress Military Prestige on Violation of Any Principle and Interaction Between Violation and Polarization)", 
          covariate.labels = c('Instance of Violation', 'House Polarization', 'Senate Polarization', 'Casualty Rate (lagged)', '2004 Election', 'Violation*Polarization (house)', 'Violation*Polarization (sen.)' ),
          dep.var.labels = c('Level of Military Prestige'),
          model.names=T,
          header=FALSE,
          column.sep.width = "-15pt",
          align=TRUE,
          font.size="small",
          no.space=TRUE,
          omit.stat=c("f", "ser"),
          float.env = "sidewaystable"
          )
```
\doublespace

The results of the regressions in Table \@ref(tab:ch4appx2) suggest that there is low endogeneity in the data. The coefficient on an instance of violation is positive and highly statistically significant in models 1, 3, and 5, but when we reinstate the control for the 2004 Election, the statistical significance for the coefficient on violation falls away. 

## Data Acknowledgement and Disclaimers 

## 2000

The data were obtained from a joint project of the Brennan Center for Justice at New York University School of Law and Professor Kenneth Goldstein of the University of Wisconsin-Madison, and includes media tracking data from the Campaign Media Analysis Group in Washington, D.C. The Brennan Center-Wisconsin project was sponsored by a grant from The Pew Charitable Trusts. The opinions expressed in this article are those of the author(s) and do not necessarily reflect the views of the Brennan Center, Professor Goldstein, or The Pew Charitable Trusts.

## 2004

The data were obtained from a project of the University of Wisconsin Advertising Project includes media tracking data from TNSMI/Campaign Media Analysis Group in Washington, D.C. The University of Wisconsin Advertising Project was sponsored by a grant from The Pew Charitable Trusts. The opinions expressed in this article are those of the author(s) and do not necessarily reflect the views of the University of Wisconsin Advertising Project or The Pew Charitable Trusts.

## 2008

The data were obtained from a project of the University of Wisconsin Advertising Project includes media tracking data from TNSMI/Campaign Media Analysis Group in Washington, D.C. The opinions expressed in this article are those of the author(s) and do not necessarily reflect the views of the University of Wisconsin Advertising Project.

## 2012

The data were obtained from the Wesleyan Media Project, a collaboration between Wesleyan University, Bowdoin College, and Washington State University, and includes media tracking data from Kantar/Campaign Media Analysis Group in Washington, D.C. The Wesleyan Media Project was sponsored in 2012 by grants from The John S. and James L. Knight Foundation and The John D. and Catherine T. MacArthur Foundation. The opinions expressed in this article are those of the author(s) and do not necessarily reflect the views of the Wesleyan Media Project, Knight Foundation, MacArthur Foundation or any of its affiliates.

## 2016

The data were obtained from the Wesleyan Media Project, a collaboration between Wesleyan University, Bowdoin College, and Washington State University, and includes media tracking data from Kantar/Campaign Media Analysis Group in Washington, D.C. The Wesleyan Media Project was sponsored in 2016 by a grant from The John S. and James L. Knight Foundation. The opinions expressed in this article are those of the author(s) and do not necessarily reflect the views of the Wesleyan Media Project, Knight Foundation, or any of its affiliates.

## Other Acknowledgements

All regression tables used in chapter three were produced with the help of the Stargazer package, designed by Marek Hlavac [@hlavac_stargazer_2018].

\pagebreak
\singlespace